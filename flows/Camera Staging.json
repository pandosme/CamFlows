[
    {
        "id": "326c4a626204f486",
        "type": "tab",
        "label": "Staging Template",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "d9b49086386388d6",
        "type": "group",
        "z": "326c4a626204f486",
        "name": "",
        "style": {
            "stroke": "#000000",
            "fill": "#ffffbf",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "1ef5f1ee91fff368",
            "d94e5b245b713eea",
            "a43341f2a3331a8f",
            "7a16ae31284fbabc",
            "9ba3ca1abb33e159",
            "134116d4f16a4b0a",
            "9e856f3c44be6d45",
            "319c392e32d0e696",
            "3c112a8e8e6d49ba",
            "80c71f2bd37ff6e3",
            "cffb73326631ea53",
            "cd767c447af66377",
            "921ba243d3422e2b"
        ],
        "x": 304,
        "y": 399,
        "w": 632,
        "h": 362
    },
    {
        "id": "66c041de4c0f6c56",
        "type": "group",
        "z": "326c4a626204f486",
        "name": "",
        "style": {
            "stroke": "#000000",
            "fill": "#ffffbf",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "5f6050277708064a",
            "d8ca3e4ba61b6190",
            "a04fad0be4199bb7",
            "155f4918c05291bd",
            "919a83876a6083f4",
            "bd475b8d5462fa90",
            "9a714588be8e54db"
        ],
        "x": 304,
        "y": 799,
        "w": 772,
        "h": 207
    },
    {
        "id": "f095b808950850b5",
        "type": "group",
        "z": "326c4a626204f486",
        "name": "",
        "style": {
            "label": true,
            "stroke": "#000000",
            "fill": "#ffffbf",
            "color": "#000000"
        },
        "nodes": [
            "775e3c795b3a9690",
            "2fe13c04f5e975c0",
            "b510d1004349fcaf",
            "2b59bf24ee0071c0",
            "4a5b247fc4a756ab"
        ],
        "x": 304,
        "y": 1039,
        "w": 592,
        "h": 167
    },
    {
        "id": "d86b9bd960926906",
        "type": "group",
        "z": "326c4a626204f486",
        "name": "",
        "style": {
            "stroke": "#000000",
            "fill": "#ffffbf",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "caa9e9d4bd12217f",
            "9a762f9675143678",
            "3faa01f4830b4342",
            "556c256bb53c822f"
        ],
        "x": 304,
        "y": 1239,
        "w": 372,
        "h": 167
    },
    {
        "id": "eb0b29098d353a3f",
        "type": "group",
        "z": "326c4a626204f486",
        "name": "",
        "style": {
            "stroke": "#000000",
            "fill": "#ffffbf",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "2085cbcfedb52c59",
            "e2fc43875924de6e",
            "80ce3ef107b5f9b7",
            "fda31862ecb0986e",
            "47fc63f7fc5a2fb4",
            "f763a3d9f9ede7e9"
        ],
        "x": 304,
        "y": 3039,
        "w": 772,
        "h": 167
    },
    {
        "id": "1de3d24cef27cac4",
        "type": "group",
        "z": "326c4a626204f486",
        "name": "",
        "style": {
            "stroke": "#000000",
            "fill": "#ffffbf",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "10a712ef4bb5643d",
            "1aabb89aedf1fc44",
            "990d0107b622c7a5",
            "cd48796123197baf",
            "f7038077f90c5d8d",
            "8fecadfa65a271c2",
            "3ff53b77a8171abd",
            "4de8030370b57e15",
            "151fad2886ead846"
        ],
        "x": 304,
        "y": 1639,
        "w": 1312,
        "h": 167
    },
    {
        "id": "2f31d414d432f126",
        "type": "group",
        "z": "326c4a626204f486",
        "name": "",
        "style": {
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "6a3b8cc76fb3e762",
            "55eb0316c3b1783a",
            "044cc6cd553e80ab",
            "b270ca85ffebf676",
            "adbdb715bdfbf95a",
            "6e70f208c9c16261",
            "cec6152c855b79ad",
            "42c76dcc8a38af8f",
            "2834e578f9eff775",
            "da175b30cfb4a040",
            "39c2c5968b861d58",
            "e616354b51e45f6e",
            "f5746c3c8b4ce912",
            "fbf9095052e45834",
            "e1441d48c701db2b",
            "c237eaf11a95db72",
            "d4f86898d10f9de4",
            "6a286cf74bf76163",
            "04c5e945ebc9e6d1",
            "2479d63d1095c530"
        ],
        "x": 304,
        "y": 1839,
        "w": 1832,
        "h": 322
    },
    {
        "id": "f68112c44c6b906d",
        "type": "group",
        "z": "326c4a626204f486",
        "name": "",
        "style": {
            "label": true,
            "stroke": "#000000",
            "fill": "#ffffbf",
            "color": "#000000"
        },
        "nodes": [
            "adf119416eac84ab",
            "0c3359e296d88dd8",
            "857ea5f8e9286dc2",
            "60661454031311e6",
            "b3f723e82f3af075",
            "b72b7783e027c102",
            "b931e5bc682cea71",
            "c55ec918a2d15797",
            "34864d882054a373"
        ],
        "x": 304,
        "y": 2399,
        "w": 1212,
        "h": 207
    },
    {
        "id": "2aa576cb106287ce",
        "type": "group",
        "z": "326c4a626204f486",
        "name": "",
        "style": {
            "label": true,
            "stroke": "#000000",
            "fill": "#ffffbf",
            "color": "#000000"
        },
        "nodes": [
            "56609e1e6821d1a1",
            "c9641f772f416cba",
            "67777b3653403471",
            "2c5a12aef042806b",
            "d88b6b9c53d39099",
            "2f82dd65fe45199b",
            "ee3602c42b9ca752",
            "6af7a17d7eaf6b2b",
            "8895aea9a9f3d1be",
            "1b94296c0d401150",
            "3419d1307b508c24",
            "f2d6ab0ff1e6d684",
            "532b2ee02b27849a"
        ],
        "x": 304,
        "y": 2199,
        "w": 1792,
        "h": 167
    },
    {
        "id": "2584543e15b45c4c",
        "type": "group",
        "z": "326c4a626204f486",
        "name": "",
        "style": {
            "stroke": "#000000",
            "fill": "#ffffbf",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "def56cf9c90d2afd",
            "739c5cb4e09b22a8",
            "8e8e7e678a16252c",
            "5c5ba15cfce44a67",
            "196e771b66b4549f",
            "1bad663002407424",
            "0960c0d22ecf070c",
            "efbf81751bd93e46",
            "da087cefbcedb17e",
            "1e9df55b3778e57b"
        ],
        "x": 304,
        "y": 2639,
        "w": 1132,
        "h": 167
    },
    {
        "id": "265fc0b774afd280",
        "type": "group",
        "z": "326c4a626204f486",
        "name": "",
        "style": {
            "label": true,
            "stroke": "#000000",
            "fill": "#ffffbf",
            "color": "#000000"
        },
        "nodes": [
            "d7eced934d70505d",
            "95730e517fbaba60",
            "bf458e5375867797",
            "6bbb3f24fcae72db",
            "234b7fe52ca39cd4",
            "ee46062e85730afe",
            "177ca280438fd577",
            "abe869d7622df0c6",
            "1986606316682d6a",
            "1f5aa0014307c385"
        ],
        "x": 304,
        "y": 2839,
        "w": 1562,
        "h": 167
    },
    {
        "id": "e5199098c110ef9d",
        "type": "group",
        "z": "326c4a626204f486",
        "name": "",
        "style": {
            "stroke": "#001f60",
            "fill": "#ffffbf",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "e8e87775d2b7a916",
            "70bf97c7a27b922b",
            "85b247d0360781b4",
            "cd6d4cd3be0bd9fc",
            "a88d2f8182b45620",
            "132463424d665729",
            "be2adcf3a4c03127"
        ],
        "x": 304,
        "y": 1439,
        "w": 962,
        "h": 167
    },
    {
        "id": "3cde0f5e5fa9ec4d",
        "type": "group",
        "z": "326c4a626204f486",
        "name": "",
        "style": {
            "stroke": "#000000",
            "fill": "#bfdbef",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "f7b1ae528e5406cc",
            "3fbd5c05eef07017",
            "6d3cbe25c6482165",
            "fce46974ec0f7e47"
        ],
        "x": 1444,
        "y": 119,
        "w": 732,
        "h": 142
    },
    {
        "id": "cd767c447af66377",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "d9b49086386388d6",
        "x": 910,
        "y": 680,
        "wires": [
            [
                "f2e502b0e5be6f23"
            ]
        ]
    },
    {
        "id": "4a5b247fc4a756ab",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "f095b808950850b5",
        "x": 490,
        "y": 1180,
        "wires": [
            [
                "a8a9e1a639404ce5"
            ]
        ]
    },
    {
        "id": "bd475b8d5462fa90",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "66c041de4c0f6c56",
        "x": 550,
        "y": 940,
        "wires": [
            [
                "a04fad0be4199bb7"
            ]
        ]
    },
    {
        "id": "9a714588be8e54db",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "66c041de4c0f6c56",
        "x": 910,
        "y": 980,
        "wires": [
            [
                "7e72277ed48d25a7"
            ]
        ]
    },
    {
        "id": "556c256bb53c822f",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "d86b9bd960926906",
        "x": 530,
        "y": 1380,
        "wires": [
            [
                "ce36dfb9299bf2a2"
            ]
        ]
    },
    {
        "id": "f763a3d9f9ede7e9",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "eb0b29098d353a3f",
        "x": 510,
        "y": 3180,
        "wires": [
            [
                "c32f7e5faf7224c8"
            ]
        ]
    },
    {
        "id": "151fad2886ead846",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "1de3d24cef27cac4",
        "x": 510,
        "y": 1780,
        "wires": [
            [
                "6e39b97d30814d56"
            ]
        ]
    },
    {
        "id": "2834e578f9eff775",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "x": 1170,
        "y": 2060,
        "wires": [
            [
                "f5746c3c8b4ce912"
            ]
        ]
    },
    {
        "id": "e616354b51e45f6e",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "x": 650,
        "y": 2000,
        "wires": [
            [
                "6e70f208c9c16261"
            ]
        ]
    },
    {
        "id": "d4f86898d10f9de4",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "x": 1750,
        "y": 2120,
        "wires": [
            [
                "2eb1c6027f38a1e4"
            ]
        ]
    },
    {
        "id": "3419d1307b508c24",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "2aa576cb106287ce",
        "x": 510,
        "y": 2340,
        "wires": [
            [
                "f2d6ab0ff1e6d684"
            ]
        ]
    },
    {
        "id": "f2d6ab0ff1e6d684",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "2aa576cb106287ce",
        "x": 1290,
        "y": 2340,
        "wires": [
            [
                "50802d2561ec3866"
            ]
        ]
    },
    {
        "id": "c55ec918a2d15797",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "f68112c44c6b906d",
        "x": 530,
        "y": 2540,
        "wires": [
            [
                "b931e5bc682cea71"
            ]
        ]
    },
    {
        "id": "34864d882054a373",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "f68112c44c6b906d",
        "x": 1150,
        "y": 2580,
        "wires": [
            [
                "88f41124c523832d"
            ]
        ]
    },
    {
        "id": "1bad663002407424",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "2584543e15b45c4c",
        "x": 550,
        "y": 2780,
        "wires": [
            [
                "efbf81751bd93e46"
            ]
        ]
    },
    {
        "id": "177ca280438fd577",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "265fc0b774afd280",
        "x": 570,
        "y": 2980,
        "wires": [
            [
                "1f5aa0014307c385"
            ]
        ]
    },
    {
        "id": "1f5aa0014307c385",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "265fc0b774afd280",
        "x": 1630,
        "y": 2980,
        "wires": [
            [
                "5e7fc1a8c1e4a852"
            ]
        ]
    },
    {
        "id": "132463424d665729",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "e5199098c110ef9d",
        "x": 490,
        "y": 1580,
        "wires": [
            [
                "be2adcf3a4c03127"
            ]
        ]
    },
    {
        "id": "be2adcf3a4c03127",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "e5199098c110ef9d",
        "x": 970,
        "y": 1580,
        "wires": [
            [
                "083f37e50c09c17d"
            ]
        ]
    },
    {
        "id": "efbf81751bd93e46",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "2584543e15b45c4c",
        "x": 930,
        "y": 2780,
        "wires": [
            [
                "1e9df55b3778e57b"
            ]
        ]
    },
    {
        "id": "1e9df55b3778e57b",
        "type": "junction",
        "z": "326c4a626204f486",
        "g": "2584543e15b45c4c",
        "x": 1270,
        "y": 2780,
        "wires": [
            [
                "4c26f5714d41a4ed"
            ]
        ]
    },
    {
        "id": "cabf8c8b416f8b26",
        "type": "inject",
        "z": "326c4a626204f486",
        "name": "Commit staging",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 190,
        "y": 500,
        "wires": [
            [
                "7a16ae31284fbabc"
            ]
        ]
    },
    {
        "id": "1ef5f1ee91fff368",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "d9b49086386388d6",
        "name": "For Each Cameras",
        "func": "msg.payload.forEach(function(device){\n    msg.address = device.address;\n    msg.name = device.name\n    node.send(msg);\n});\n",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 800,
        "y": 500,
        "wires": [
            [
                "d94e5b245b713eea"
            ]
        ]
    },
    {
        "id": "f2e502b0e5be6f23",
        "type": "link out",
        "z": "326c4a626204f486",
        "name": "Device",
        "mode": "link",
        "links": [
            "93480b4fecbe79c8"
        ],
        "x": 1165,
        "y": 680,
        "wires": []
    },
    {
        "id": "25241a831a4df753",
        "type": "inject",
        "z": "326c4a626204f486",
        "name": "Set System Config",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 190,
        "y": 140,
        "wires": [
            [
                "fb255cfa555a8da1"
            ]
        ]
    },
    {
        "id": "fb255cfa555a8da1",
        "type": "template",
        "z": "326c4a626204f486",
        "name": "System Config",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{\n    \"accounts\": [\n        {\n            \"name\": \"\",\n            \"password\": \"\",\n            \"privileges\": \"Admin\"\n        }\n    ],\n    \"timezone\": \"Europe/Stockholm\",\n    \"zipstream\": {\n        \"strength\": 20,\n        \"minfps\": 15\n    },\n    \"tls\": {\n        \"policy\": \"HttpAndHttps\"\n    },\n    \"textOverlays\": [\n        {\n            \"text\": \"%F %X\",\n            \"position\": \"topLeft\",\n            \"textColor\": \"white\",\n            \"textBGColor\": \"black\",\n            \"fontSize\": 48\n        },\n        {\n            \"text\": \"#n\",\n            \"position\": \"topRight\",\n            \"textColor\": \"white\",\n            \"textBGColor\": \"transparent\",\n            \"fontSize\": 48\n        }\n    ], \n    \"imageOverlay\": {\n        \"filepath\": \"staging/smiley.png\",\n        \"position\":\"bottomRight\",\n        \"scale\": true,\n        \"alpha\": 0\n    },\n    \"onvif\": [\n        {\n            \"name\": \"user1\",\n            \"password\": \"user2\",\n            \"privileges\": \"Administrator\"\n        }\n    ],\n    \"mqtt\": {\n        \"address\":\"\",\n        \"user\": \"\",\n        \"password\":\"\",\n        \"publish\": [\n\t\t\t{\n\t\t\t\t\"qos\": 0,\n\t\t\t\t\"retain\": \"none\",\n\t\t\t\t\"topicFilter\": \"axis:CameraApplicationPlatform/ObjectAnalytics/Device1Scenario1\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"qos\": 0,\n\t\t\t\t\"retain\": \"none\",\n\t\t\t\t\"topicFilter\": \"axis:CameraApplicationPlatform/ObjectAnalytics/Device1Scenario2\"\n\t\t\t}\n\t\t]\n    },\n    \"ssh\": {\n        \"name\": \"\",\n        \"password\":\"\"\n    },\n    \"acaps\": [\n        {\n            \"package\": \"\",\n            \"eap\":{\n                \"armv7hf\": \"\",\n                \"aarch64\": \"\"\n            },\n            \"config\": {\n                \"url\": \"\",\n                \"data\": \"\"\n            }\n        }\n    ]\n}\n",
        "output": "json",
        "x": 420,
        "y": 140,
        "wires": [
            [
                "06f1570875e71943"
            ]
        ]
    },
    {
        "id": "06f1570875e71943",
        "type": "change",
        "z": "326c4a626204f486",
        "name": "flow.config",
        "rules": [
            {
                "t": "set",
                "p": "config",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 140,
        "wires": [
            [
                "d8eb2f83ff36d2e9",
                "2580e585c59bdc99"
            ]
        ]
    },
    {
        "id": "d94e5b245b713eea",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "d9b49086386388d6",
        "name": "Main Account",
        "func": "if (!msg.config.hasOwnProperty(\"accounts\") || !Array.isArray(msg.config.accounts)) {\n    node.error(\"Invalid accounts config\", msg);\n    return;\n}\n\nif( msg.config.accounts.length === 0 ) {\n    node.error(\"No accounts defined\", msg);\n    return;\n}\n\nif (!msg.config.accounts[0].hasOwnProperty(\"name\") || msg.config.accounts[0].name.length < 2) {\n    node.error(\"Invalid account name\", msg);\n    return;\n}\n\nif (!msg.config.accounts[0].hasOwnProperty(\"password\") || msg.config.accounts[0].password.length < 5) {\n    node.error(\"Invalid account password\", msg);\n    return;\n}\n\nmsg.user = msg.config.accounts[0].name;\nmsg.password = msg.config.accounts[0].password;\n\nmsg.payload = {\n    \"name\": msg.user,\n    \"password\": msg.password,\n    \"privileges\": \"Admin\"\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 560,
        "wires": [
            [
                "a43341f2a3331a8f"
            ]
        ]
    },
    {
        "id": "a43341f2a3331a8f",
        "type": "Axis Security",
        "z": "326c4a626204f486",
        "g": "d9b49086386388d6",
        "name": "",
        "preset": "1af13a1540441ff9",
        "address": "",
        "action": "Set account",
        "data": "",
        "options": "",
        "x": 640,
        "y": 560,
        "wires": [
            [
                "9ba3ca1abb33e159"
            ]
        ]
    },
    {
        "id": "d8eb2f83ff36d2e9",
        "type": "template",
        "z": "326c4a626204f486",
        "name": "Device Inventory",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "[\n    {\n        \"address\":\"10.13.8.167\",\n        \"name\":\"democam\"\n    }\n]\n",
        "output": "json",
        "x": 430,
        "y": 200,
        "wires": [
            [
                "0b4544f00b60691a"
            ]
        ]
    },
    {
        "id": "0b4544f00b60691a",
        "type": "change",
        "z": "326c4a626204f486",
        "name": "flow.inventory",
        "rules": [
            {
                "t": "set",
                "p": "inventory",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 200,
        "wires": [
            [
                "625b86ce52be741b"
            ]
        ]
    },
    {
        "id": "7a16ae31284fbabc",
        "type": "change",
        "z": "326c4a626204f486",
        "g": "d9b49086386388d6",
        "name": "Init",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "inventory",
                "tot": "flow",
                "dc": true
            },
            {
                "t": "set",
                "p": "config",
                "pt": "msg",
                "to": "config",
                "tot": "flow",
                "dc": true
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 500,
        "wires": [
            [
                "921ba243d3422e2b"
            ]
        ]
    },
    {
        "id": "9ba3ca1abb33e159",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "d9b49086386388d6",
        "name": "",
        "preset": "1af13a1540441ff9",
        "action": "Device Info",
        "cgi": "",
        "data": "",
        "options": "",
        "filename": "",
        "x": 440,
        "y": 620,
        "wires": [
            [
                "134116d4f16a4b0a"
            ]
        ]
    },
    {
        "id": "134116d4f16a4b0a",
        "type": "change",
        "z": "326c4a626204f486",
        "g": "d9b49086386388d6",
        "name": "msg.device",
        "rules": [
            {
                "t": "set",
                "p": "device",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 720,
        "y": 620,
        "wires": [
            [
                "319c392e32d0e696"
            ]
        ]
    },
    {
        "id": "9e856f3c44be6d45",
        "type": "comment",
        "z": "326c4a626204f486",
        "g": "d9b49086386388d6",
        "name": "Run staging",
        "info": "",
        "x": 400,
        "y": 440,
        "wires": []
    },
    {
        "id": "48126a275c38ec3b",
        "type": "link in",
        "z": "326c4a626204f486",
        "name": "link in 15",
        "links": [
            "7759a64df04bf9b1",
            "b32ddcb5223ab036",
            "c32f7e5faf7224c8"
        ],
        "x": 415,
        "y": 320,
        "wires": [
            [
                "3de21fa3435d6c92"
            ]
        ]
    },
    {
        "id": "3de21fa3435d6c92",
        "type": "debug",
        "z": "326c4a626204f486",
        "name": "debug 148",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 600,
        "y": 320,
        "wires": []
    },
    {
        "id": "c1ca175c357eb3f3",
        "type": "catch",
        "z": "326c4a626204f486",
        "name": "",
        "scope": null,
        "uncaught": true,
        "x": 410,
        "y": 280,
        "wires": [
            [
                "c7a073b986113bec"
            ]
        ]
    },
    {
        "id": "c7a073b986113bec",
        "type": "debug",
        "z": "326c4a626204f486",
        "name": "debug 149",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 600,
        "y": 280,
        "wires": []
    },
    {
        "id": "3c112a8e8e6d49ba",
        "type": "change",
        "z": "326c4a626204f486",
        "g": "d9b49086386388d6",
        "name": "msg.camera",
        "rules": [
            {
                "t": "set",
                "p": "camera",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 680,
        "wires": [
            [
                "cd767c447af66377"
            ]
        ]
    },
    {
        "id": "319c392e32d0e696",
        "type": "Axis camera",
        "z": "326c4a626204f486",
        "g": "d9b49086386388d6",
        "name": "",
        "preset": "1af13a1540441ff9",
        "action": "Camera Info",
        "resolution": "640x360",
        "output": "Base64",
        "filename": "",
        "options": "",
        "data": "",
        "x": 440,
        "y": 680,
        "wires": [
            [
                "3c112a8e8e6d49ba"
            ]
        ]
    },
    {
        "id": "80c71f2bd37ff6e3",
        "type": "catch",
        "z": "326c4a626204f486",
        "g": "d9b49086386388d6",
        "name": "",
        "scope": [
            "319c392e32d0e696"
        ],
        "uncaught": false,
        "x": 440,
        "y": 720,
        "wires": [
            [
                "cffb73326631ea53"
            ]
        ]
    },
    {
        "id": "cffb73326631ea53",
        "type": "change",
        "z": "326c4a626204f486",
        "g": "d9b49086386388d6",
        "name": "msg.camera",
        "rules": [
            {
                "t": "set",
                "p": "camera",
                "pt": "msg",
                "to": "null",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 720,
        "wires": [
            [
                "cd767c447af66377"
            ]
        ]
    },
    {
        "id": "58341a3cca1bbec2",
        "type": "comment",
        "z": "326c4a626204f486",
        "name": "For Each Device",
        "info": "",
        "x": 1050,
        "y": 680,
        "wires": []
    },
    {
        "id": "93480b4fecbe79c8",
        "type": "link in",
        "z": "326c4a626204f486",
        "name": "Add accounts",
        "links": [
            "f2e502b0e5be6f23"
        ],
        "x": 245,
        "y": 900,
        "wires": [
            [
                "5f6050277708064a"
            ]
        ]
    },
    {
        "id": "7e72277ed48d25a7",
        "type": "link out",
        "z": "326c4a626204f486",
        "name": "link out 20",
        "mode": "link",
        "links": [
            "d9fe5bc41f3ea8ab"
        ],
        "x": 1145,
        "y": 980,
        "wires": []
    },
    {
        "id": "d9fe5bc41f3ea8ab",
        "type": "link in",
        "z": "326c4a626204f486",
        "name": "Set Name",
        "links": [
            "7e72277ed48d25a7"
        ],
        "x": 255,
        "y": 1140,
        "wires": [
            [
                "b510d1004349fcaf"
            ]
        ]
    },
    {
        "id": "a8a9e1a639404ce5",
        "type": "link out",
        "z": "326c4a626204f486",
        "name": "link out 21",
        "mode": "link",
        "links": [
            "6bb1b818b1358ce4"
        ],
        "x": 955,
        "y": 1180,
        "wires": []
    },
    {
        "id": "6bb1b818b1358ce4",
        "type": "link in",
        "z": "326c4a626204f486",
        "name": "Timezone",
        "links": [
            "a8a9e1a639404ce5"
        ],
        "x": 255,
        "y": 1340,
        "wires": [
            [
                "9a762f9675143678"
            ]
        ]
    },
    {
        "id": "ce36dfb9299bf2a2",
        "type": "link out",
        "z": "326c4a626204f486",
        "name": "link out 22",
        "mode": "link",
        "links": [
            "37103ed07643fd65"
        ],
        "x": 735,
        "y": 1380,
        "wires": []
    },
    {
        "id": "5f6050277708064a",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "66c041de4c0f6c56",
        "name": "2:nd Account",
        "func": "if( msg.config.accounts.length < 2 ) {\n    node.send([null,msg]);\n    return;\n}\n\nmsg.payload = {\n    name: msg.config.accounts[1].name,\n    password: msg.config.accounts[1].password,\n    privileges: msg.config.accounts[1].privileges\n}\nnode.send([msg,null]);",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 900,
        "wires": [
            [
                "d8ca3e4ba61b6190"
            ],
            [
                "bd475b8d5462fa90"
            ]
        ]
    },
    {
        "id": "d8ca3e4ba61b6190",
        "type": "Axis Security",
        "z": "326c4a626204f486",
        "g": "66c041de4c0f6c56",
        "name": "",
        "preset": "1af13a1540441ff9",
        "address": "",
        "action": "Set account",
        "data": "",
        "options": "",
        "x": 620,
        "y": 900,
        "wires": [
            [
                "a04fad0be4199bb7"
            ]
        ]
    },
    {
        "id": "a04fad0be4199bb7",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "66c041de4c0f6c56",
        "name": "3:nd Account",
        "func": "if( msg.config.accounts.length < 3 ) {\n    node.send([null,msg]);\n    return;\n}\n\nmsg.payload = {\n    name: msg.config.accounts[2].name,\n    password: msg.config.accounts[2].password,\n    privileges: msg.config.accounts[2].privileges\n}\nnode.send([msg,null]);",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 780,
        "y": 940,
        "wires": [
            [
                "155f4918c05291bd"
            ],
            [
                "9a714588be8e54db"
            ]
        ]
    },
    {
        "id": "155f4918c05291bd",
        "type": "Axis Security",
        "z": "326c4a626204f486",
        "g": "66c041de4c0f6c56",
        "name": "",
        "preset": "1af13a1540441ff9",
        "address": "",
        "action": "Set account",
        "data": "",
        "options": "",
        "x": 980,
        "y": 940,
        "wires": [
            [
                "7e72277ed48d25a7"
            ]
        ]
    },
    {
        "id": "919a83876a6083f4",
        "type": "comment",
        "z": "326c4a626204f486",
        "g": "66c041de4c0f6c56",
        "name": "Add additional accounts",
        "info": "",
        "x": 430,
        "y": 840,
        "wires": []
    },
    {
        "id": "775e3c795b3a9690",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "f095b808950850b5",
        "name": "",
        "preset": "1af13a1540441ff9",
        "action": "Set name",
        "cgi": "",
        "data": "",
        "options": "",
        "filename": "",
        "x": 810,
        "y": 1140,
        "wires": [
            [
                "a8a9e1a639404ce5"
            ]
        ]
    },
    {
        "id": "2fe13c04f5e975c0",
        "type": "change",
        "z": "326c4a626204f486",
        "g": "f095b808950850b5",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "name",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 600,
        "y": 1140,
        "wires": [
            [
                "775e3c795b3a9690"
            ]
        ]
    },
    {
        "id": "b510d1004349fcaf",
        "type": "switch",
        "z": "326c4a626204f486",
        "g": "f095b808950850b5",
        "name": "If set",
        "property": "name.length",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gt",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 380,
        "y": 1140,
        "wires": [
            [
                "2fe13c04f5e975c0"
            ],
            [
                "4a5b247fc4a756ab"
            ]
        ]
    },
    {
        "id": "2b59bf24ee0071c0",
        "type": "comment",
        "z": "326c4a626204f486",
        "g": "f095b808950850b5",
        "name": "Set name for host, PnP and Bonjour",
        "info": "",
        "x": 470,
        "y": 1080,
        "wires": []
    },
    {
        "id": "caa9e9d4bd12217f",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "d86b9bd960926906",
        "name": "",
        "preset": "1af13a1540441ff9",
        "action": "Set time",
        "cgi": "",
        "data": "",
        "options": "",
        "filename": "",
        "x": 590,
        "y": 1340,
        "wires": [
            [
                "ce36dfb9299bf2a2"
            ]
        ]
    },
    {
        "id": "9a762f9675143678",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "d86b9bd960926906",
        "name": "Timezone",
        "func": "/*\n{\n  timezone: \"Europe/London\",\n  ntp: [\"1.2.3.4\",\"2.3.4.5\"]\n}\n*/\n\nif( !msg.config.hasOwnProperty(\"timezone\") || msg.config.timezone.length < 5) {\n  node.send([null,msg]);\n  return;\n}\n\nmsg.payload = {\n    timezone: msg.config.timezone\n}\n\nnode.send([msg,null]);\n",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 1340,
        "wires": [
            [
                "caa9e9d4bd12217f"
            ],
            [
                "556c256bb53c822f"
            ]
        ]
    },
    {
        "id": "3faa01f4830b4342",
        "type": "comment",
        "z": "326c4a626204f486",
        "g": "d86b9bd960926906",
        "name": "Timezone                                            ",
        "info": "",
        "x": 390,
        "y": 1280,
        "wires": []
    },
    {
        "id": "b59aef61313a54fa",
        "type": "link in",
        "z": "326c4a626204f486",
        "name": "SSH",
        "links": [
            "5e7fc1a8c1e4a852"
        ],
        "x": 265,
        "y": 3140,
        "wires": [
            [
                "fda31862ecb0986e"
            ]
        ]
    },
    {
        "id": "c32f7e5faf7224c8",
        "type": "link out",
        "z": "326c4a626204f486",
        "name": "link out 23",
        "mode": "link",
        "links": [
            "48126a275c38ec3b"
        ],
        "x": 1145,
        "y": 3180,
        "wires": []
    },
    {
        "id": "fcedd833c527e980",
        "type": "link in",
        "z": "326c4a626204f486",
        "name": "TLS",
        "links": [
            "083f37e50c09c17d"
        ],
        "x": 255,
        "y": 1740,
        "wires": [
            [
                "4de8030370b57e15"
            ]
        ]
    },
    {
        "id": "6e39b97d30814d56",
        "type": "link out",
        "z": "326c4a626204f486",
        "name": "link out 24",
        "mode": "link",
        "links": [
            "8c63f58133b9e7b1"
        ],
        "x": 1685,
        "y": 1780,
        "wires": []
    },
    {
        "id": "2085cbcfedb52c59",
        "type": "Axis Security",
        "z": "326c4a626204f486",
        "g": "eb0b29098d353a3f",
        "name": "",
        "preset": "1af13a1540441ff9",
        "address": "",
        "action": "Allow SSH",
        "data": "",
        "options": "",
        "x": 580,
        "y": 3140,
        "wires": [
            [
                "47fc63f7fc5a2fb4"
            ]
        ]
    },
    {
        "id": "e2fc43875924de6e",
        "type": "Axis Security",
        "z": "326c4a626204f486",
        "g": "eb0b29098d353a3f",
        "name": "",
        "preset": "1af13a1540441ff9",
        "address": "",
        "action": "Set SSH User",
        "data": "",
        "options": "",
        "x": 970,
        "y": 3140,
        "wires": [
            [
                "c32f7e5faf7224c8"
            ]
        ]
    },
    {
        "id": "80ce3ef107b5f9b7",
        "type": "comment",
        "z": "326c4a626204f486",
        "g": "eb0b29098d353a3f",
        "name": "Enable SSH",
        "info": "",
        "x": 400,
        "y": 3080,
        "wires": []
    },
    {
        "id": "10a712ef4bb5643d",
        "type": "template",
        "z": "326c4a626204f486",
        "g": "1de3d24cef27cac4",
        "name": "Set TLS Policy",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Envelope xmlns=\"http://www.w3.org/2003/05/soap-envelope\">\n <Header/>\n <Body >\n<SetWebServerTlsConfiguration xmlns=\"http://www.axis.com/vapix/ws/webserver\" xmlns:acert=\"http://www.axis.com/vapix/ws/cert\">\n          <Configuration>\n              <Tls>true</Tls>\n              <ConnectionPolicies>\n                  <Admin>{{config.tls.policy}}</Admin>\n              </ConnectionPolicies>\n              <Ciphers>\n                  <acert:Cipher>ECDHE-ECDSA-AES128-GCM-SHA256</acert:Cipher><acert:Cipher>ECDHE-RSA-AES128-GCM-SHA256</acert:Cipher><acert:Cipher>ECDHE-ECDSA-AES256-GCM-SHA384</acert:Cipher><acert:Cipher>ECDHE-RSA-AES256-GCM-SHA384</acert:Cipher><acert:Cipher>ECDHE-ECDSA-CHACHA20-POLY1305</acert:Cipher><acert:Cipher>ECDHE-RSA-CHACHA20-POLY1305</acert:Cipher><acert:Cipher>DHE-RSA-AES128-GCM-SHA256</acert:Cipher><acert:Cipher>DHE-RSA-AES256-GCM-SHA384</acert:Cipher>\n              </Ciphers>\n              <CertificateSet>\n                  <acert:Certificates><acert:Id>{{payload}}</acert:Id></acert:Certificates>\n                  <acert:CACertificates></acert:CACertificates>\n                  <acert:TrustedCertificates></acert:TrustedCertificates>\n              </CertificateSet>\n          </Configuration>\n      </SetWebServerTlsConfiguration>\n </Body>\n</Envelope>",
        "output": "str",
        "x": 1310,
        "y": 1740,
        "wires": [
            [
                "1aabb89aedf1fc44"
            ]
        ]
    },
    {
        "id": "1aabb89aedf1fc44",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "1de3d24cef27cac4",
        "name": "/vapix/services",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Post",
        "cgi": "/vapix/services",
        "data": "",
        "options": "",
        "filename": "",
        "x": 1510,
        "y": 1740,
        "wires": [
            [
                "6e39b97d30814d56"
            ]
        ]
    },
    {
        "id": "990d0107b622c7a5",
        "type": "template",
        "z": "326c4a626204f486",
        "g": "1de3d24cef27cac4",
        "name": "Get TLS Policy",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Envelope xmlns=\"http://www.w3.org/2003/05/soap-envelope\">\n <Header/>\n <Body >\n<GetWebServerTlsConfiguration xmlns=\"http://www.axis.com/vapix/ws/webserver\">\n    </GetWebServerTlsConfiguration>\n </Body>\n</Envelope>",
        "output": "str",
        "x": 590,
        "y": 1740,
        "wires": [
            [
                "cd48796123197baf"
            ]
        ]
    },
    {
        "id": "cd48796123197baf",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "1de3d24cef27cac4",
        "name": "/vapix/services",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Post",
        "cgi": "/vapix/services",
        "data": "",
        "options": "",
        "filename": "",
        "x": 790,
        "y": 1740,
        "wires": [
            [
                "f7038077f90c5d8d"
            ]
        ]
    },
    {
        "id": "f7038077f90c5d8d",
        "type": "xml",
        "z": "326c4a626204f486",
        "g": "1de3d24cef27cac4",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 960,
        "y": 1740,
        "wires": [
            [
                "8fecadfa65a271c2"
            ]
        ]
    },
    {
        "id": "8fecadfa65a271c2",
        "type": "change",
        "z": "326c4a626204f486",
        "g": "1de3d24cef27cac4",
        "name": "Certificate ID",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload['SOAP-ENV:Envelope']['SOAP-ENV:Body'][0]['aweb:GetWebServerTlsConfigurationResponse'][0]['aweb:Configuration'][0]['aweb:CertificateSet'][0]['acert:Certificates'][0]['acert:Id'][0]",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1120,
        "y": 1740,
        "wires": [
            [
                "10a712ef4bb5643d"
            ]
        ]
    },
    {
        "id": "3ff53b77a8171abd",
        "type": "comment",
        "z": "326c4a626204f486",
        "g": "1de3d24cef27cac4",
        "name": "Set access policy (HTTP and/or HTTP)",
        "info": "",
        "x": 480,
        "y": 1680,
        "wires": []
    },
    {
        "id": "fda31862ecb0986e",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "eb0b29098d353a3f",
        "name": "SSH",
        "func": "if( !msg.config.hasOwnProperty(\"ssh\") || typeof msg.config.ssh !== \"object\" ) {\n  node.send([null,msg]);\n  return;\n}\n\nif( !msg.config.ssh.hasOwnProperty(\"name\") || msg.config.ssh.name.length < 3 ) {\n    node.send([null,msg]);\n    return;\n}\n\nif( !msg.config.ssh.hasOwnProperty(\"password\") || msg.config.ssh.password.length < 3 ) {\n    node.send([null,msg]);\n    return;\n}\n\nmsg.payload = true;\nnode.send([msg,null]);\n",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 380,
        "y": 3140,
        "wires": [
            [
                "2085cbcfedb52c59"
            ],
            [
                "f763a3d9f9ede7e9"
            ]
        ]
    },
    {
        "id": "47fc63f7fc5a2fb4",
        "type": "change",
        "z": "326c4a626204f486",
        "g": "eb0b29098d353a3f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "config.ssh",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 770,
        "y": 3140,
        "wires": [
            [
                "e2fc43875924de6e"
            ]
        ]
    },
    {
        "id": "4de8030370b57e15",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "1de3d24cef27cac4",
        "name": "TLS policy",
        "func": "if( !msg.config.hasOwnProperty(\"tls\") || typeof msg.config.tls !== \"string\" || msg.config.tls.length < 4) {\n  node.send([null,msg]);\n  return;\n}\nnode.send([msg,null]);\n",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 1740,
        "wires": [
            [
                "990d0107b622c7a5"
            ],
            [
                "151fad2886ead846"
            ]
        ]
    },
    {
        "id": "dd5c42dcc59fbfb9",
        "type": "link in",
        "z": "326c4a626204f486",
        "name": "Text Overlays",
        "links": [
            "50802d2561ec3866"
        ],
        "x": 255,
        "y": 2500,
        "wires": [
            [
                "b72b7783e027c102"
            ]
        ]
    },
    {
        "id": "88f41124c523832d",
        "type": "link out",
        "z": "326c4a626204f486",
        "name": "link out 25",
        "mode": "link",
        "links": [
            "88244c5b493b1c97"
        ],
        "x": 1575,
        "y": 2580,
        "wires": []
    },
    {
        "id": "8c63f58133b9e7b1",
        "type": "link in",
        "z": "326c4a626204f486",
        "name": "ONVIF",
        "links": [
            "6e39b97d30814d56"
        ],
        "x": 255,
        "y": 1940,
        "wires": [
            [
                "55eb0316c3b1783a"
            ]
        ]
    },
    {
        "id": "2eb1c6027f38a1e4",
        "type": "link out",
        "z": "326c4a626204f486",
        "name": "link out 26",
        "mode": "link",
        "links": [
            "af7ee4336a48c7fb"
        ],
        "x": 2215,
        "y": 2120,
        "wires": []
    },
    {
        "id": "6a3b8cc76fb3e762",
        "type": "template",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "XML",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<? xml version = \"1.0\" encoding = \"UTF-8\" ?>\n<Envelope xmlns=\"http://www.w3.org/2003/05/soap-envelope\">\n    <Header />\n    <Body >\n        <CreateUsers xmlns=\"http://www.onvif.org/ver10/device/wsdl\" xmlns:tt=\"http://www.onvif.org/ver10/schema\">\n            <User>\n                <tt:Username>{{payload.name}}</tt:Username>\n                <tt:Password>{{payload.password}}</tt:Password>\n                <tt:UserLevel>{{payload.privileges}}</tt:UserLevel>\n            </User>\n        </CreateUsers>\n    </Body>\n</Envelope>\n",
        "output": "str",
        "x": 640,
        "y": 1940,
        "wires": [
            [
                "044cc6cd553e80ab"
            ]
        ]
    },
    {
        "id": "55eb0316c3b1783a",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "ONVIF USER 1",
        "func": "if (!msg.config.hasOwnProperty(\"onvif\") || !Array.isArray(msg.config.onvif) || msg.config.onvif.length < 1 ) {\n    node.send([null,msg]);\n    return;\n}\n\nmsg.payload = msg.config.onvif[0];\nnode.send([msg,null]);",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 1940,
        "wires": [
            [
                "6a3b8cc76fb3e762"
            ],
            [
                "e616354b51e45f6e"
            ]
        ]
    },
    {
        "id": "044cc6cd553e80ab",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "Add ONVIF User 1",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Post",
        "cgi": "/vapix/services",
        "data": "",
        "options": "",
        "filename": "",
        "x": 820,
        "y": 1940,
        "wires": [
            [
                "6e70f208c9c16261"
            ]
        ]
    },
    {
        "id": "b270ca85ffebf676",
        "type": "catch",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "",
        "scope": [
            "044cc6cd553e80ab"
        ],
        "uncaught": false,
        "x": 380,
        "y": 2000,
        "wires": [
            [
                "6a286cf74bf76163"
            ]
        ]
    },
    {
        "id": "adbdb715bdfbf95a",
        "type": "template",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "XML",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<? xml version = \"1.0\" encoding = \"UTF-8\" ?>\n<Envelope xmlns=\"http://www.w3.org/2003/05/soap-envelope\">\n    <Header />\n    <Body >\n        <CreateUsers xmlns=\"http://www.onvif.org/ver10/device/wsdl\" xmlns:tt=\"http://www.onvif.org/ver10/schema\">\n            <User>\n                <tt:Username>{{payload.name}}</tt:Username>\n                <tt:Password>{{payload.password}}</tt:Password>\n                <tt:UserLevel>{{payload.privileges}}</tt:UserLevel>\n            </User>\n        </CreateUsers>\n    </Body>\n</Envelope>\n",
        "output": "str",
        "x": 1220,
        "y": 2000,
        "wires": [
            [
                "cec6152c855b79ad"
            ]
        ]
    },
    {
        "id": "6e70f208c9c16261",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "ONVIF USER 2",
        "func": "if (!msg.config.hasOwnProperty(\"onvif\") || !Array.isArray(msg.config.onvif) || msg.config.onvif.length < 2) {\n    node.send([null, msg]);\n    return;\n}\n\nmsg.payload = msg.config.onvif[1];\nnode.send([msg, null]);",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1050,
        "y": 2000,
        "wires": [
            [
                "adbdb715bdfbf95a"
            ],
            [
                "2834e578f9eff775"
            ]
        ]
    },
    {
        "id": "cec6152c855b79ad",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "Add ONVIF User 2",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Post",
        "cgi": "/vapix/services",
        "data": "",
        "options": "",
        "filename": "",
        "x": 1400,
        "y": 2000,
        "wires": [
            [
                "f5746c3c8b4ce912"
            ]
        ]
    },
    {
        "id": "42c76dcc8a38af8f",
        "type": "catch",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "",
        "scope": [
            "cec6152c855b79ad"
        ],
        "uncaught": false,
        "x": 940,
        "y": 2060,
        "wires": [
            [
                "04c5e945ebc9e6d1"
            ]
        ]
    },
    {
        "id": "da175b30cfb4a040",
        "type": "comment",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "Set ONVIF users",
        "info": "",
        "x": 420,
        "y": 1880,
        "wires": []
    },
    {
        "id": "39c2c5968b861d58",
        "type": "comment",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "On error, user already exists.",
        "info": "",
        "x": 530,
        "y": 2040,
        "wires": []
    },
    {
        "id": "adf119416eac84ab",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "f68112c44c6b906d",
        "name": "dynamicoverlay.cgi",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Post",
        "cgi": "/axis-cgi/dynamicoverlay/dynamicoverlay.cgi",
        "data": "",
        "options": "",
        "filename": "",
        "x": 620,
        "y": 2500,
        "wires": [
            [
                "60661454031311e6"
            ]
        ]
    },
    {
        "id": "0c3359e296d88dd8",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "f68112c44c6b906d",
        "name": "dynamicoverlay.cgi",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Post",
        "cgi": "/axis-cgi/dynamicoverlay/dynamicoverlay.cgi",
        "data": "",
        "options": "",
        "filename": "",
        "x": 1240,
        "y": 2540,
        "wires": [
            [
                "b3f723e82f3af075"
            ]
        ]
    },
    {
        "id": "857ea5f8e9286dc2",
        "type": "comment",
        "z": "326c4a626204f486",
        "g": "f68112c44c6b906d",
        "name": "Set Text Overlays",
        "info": "",
        "x": 420,
        "y": 2440,
        "wires": []
    },
    {
        "id": "60661454031311e6",
        "type": "delay",
        "z": "326c4a626204f486",
        "g": "f68112c44c6b906d",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 810,
        "y": 2500,
        "wires": [
            [
                "b931e5bc682cea71"
            ]
        ]
    },
    {
        "id": "b3f723e82f3af075",
        "type": "delay",
        "z": "326c4a626204f486",
        "g": "f68112c44c6b906d",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1430,
        "y": 2540,
        "wires": [
            [
                "88f41124c523832d"
            ]
        ]
    },
    {
        "id": "f5746c3c8b4ce912",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "ONVIF USER 3",
        "func": "if (!msg.config.hasOwnProperty(\"onvif\") || !Array.isArray(msg.config.onvif) || msg.config.onvif.length < 3) {\n    node.send([null, msg]);\n    return;\n}\n\nmsg.payload = msg.config.onvif[2];\nnode.send([msg, null]);",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1630,
        "y": 2060,
        "wires": [
            [
                "fbf9095052e45834"
            ],
            [
                "d4f86898d10f9de4"
            ]
        ]
    },
    {
        "id": "fbf9095052e45834",
        "type": "template",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "XML",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<? xml version = \"1.0\" encoding = \"UTF-8\" ?>\n<Envelope xmlns=\"http://www.w3.org/2003/05/soap-envelope\">\n    <Header />\n    <Body >\n        <CreateUsers xmlns=\"http://www.onvif.org/ver10/device/wsdl\" xmlns:tt=\"http://www.onvif.org/ver10/schema\">\n            <User>\n                <tt:Username>{{payload.name}}</tt:Username>\n                <tt:Password>{{payload.password}}</tt:Password>\n                <tt:UserLevel>{{payload.privileges}}</tt:UserLevel>\n            </User>\n        </CreateUsers>\n    </Body>\n</Envelope>\n",
        "output": "str",
        "x": 1800,
        "y": 2060,
        "wires": [
            [
                "e1441d48c701db2b"
            ]
        ]
    },
    {
        "id": "e1441d48c701db2b",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "Add ONVIF User 3",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Post",
        "cgi": "/vapix/services",
        "data": "",
        "options": "",
        "filename": "",
        "x": 2020,
        "y": 2060,
        "wires": [
            []
        ]
    },
    {
        "id": "c237eaf11a95db72",
        "type": "catch",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "",
        "scope": [
            "e1441d48c701db2b"
        ],
        "uncaught": false,
        "x": 1520,
        "y": 2120,
        "wires": [
            [
                "2479d63d1095c530"
            ]
        ]
    },
    {
        "id": "921ba243d3422e2b",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "d9b49086386388d6",
        "name": "Validate",
        "func": "if(!msg.config || typeof msg.config !== \"object\"){\n    node.error(\"No config defined\", msg);\n    return;\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 590,
        "y": 500,
        "wires": [
            [
                "1ef5f1ee91fff368"
            ]
        ]
    },
    {
        "id": "af7ee4336a48c7fb",
        "type": "link in",
        "z": "326c4a626204f486",
        "name": "Remove overlays",
        "links": [
            "2eb1c6027f38a1e4"
        ],
        "x": 255,
        "y": 2300,
        "wires": [
            [
                "56609e1e6821d1a1"
            ]
        ]
    },
    {
        "id": "56609e1e6821d1a1",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "2aa576cb106287ce",
        "name": "List Overlay",
        "func": "if (!msg.config.hasOwnProperty(\"textOverlays\") || !Array.isArray(msg.config.textOverlays) || msg.config.textOverlays.length === 0) {\n    node.send([null,msg]);\n    return;\n}\n\nmsg.payload = {\n    \"apiVersion\": \"1.6\",\n    \"method\": \"list\",\n    \"params\": {}\n}\nreturn msg;",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 2300,
        "wires": [
            [
                "67777b3653403471"
            ],
            [
                "3419d1307b508c24"
            ]
        ]
    },
    {
        "id": "c9641f772f416cba",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "2aa576cb106287ce",
        "name": "Check error",
        "func": "if( msg.payload.hasOwnProperty(\"error\") ) {\n    node.error( msg.payload.error.message, msg);\n    return;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 800,
        "y": 2300,
        "wires": [
            [
                "2c5a12aef042806b"
            ]
        ]
    },
    {
        "id": "67777b3653403471",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "2aa576cb106287ce",
        "name": "dynamicoverlay.cgi",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Post",
        "cgi": "/axis-cgi/dynamicoverlay/dynamicoverlay.cgi",
        "data": "",
        "options": "",
        "filename": "",
        "x": 600,
        "y": 2300,
        "wires": [
            [
                "c9641f772f416cba"
            ]
        ]
    },
    {
        "id": "2c5a12aef042806b",
        "type": "change",
        "z": "326c4a626204f486",
        "g": "2aa576cb106287ce",
        "name": "textOverlays",
        "rules": [
            {
                "t": "set",
                "p": "imageOverlays",
                "pt": "msg",
                "to": "payload.imageOverlays",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.data.textOverlays",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 980,
        "y": 2300,
        "wires": [
            [
                "8895aea9a9f3d1be"
            ]
        ]
    },
    {
        "id": "d88b6b9c53d39099",
        "type": "split",
        "z": "326c4a626204f486",
        "g": "2aa576cb106287ce",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 1340,
        "y": 2300,
        "wires": [
            [
                "2f82dd65fe45199b"
            ]
        ]
    },
    {
        "id": "2f82dd65fe45199b",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "2aa576cb106287ce",
        "name": "Remove",
        "func": "msg.payload = {\n    \"apiVersion\": \"1.6\",\n    \"method\": \"remove\",\n    \"params\": {\n         \"identity\": msg.payload.identity \n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1490,
        "y": 2300,
        "wires": [
            [
                "ee3602c42b9ca752"
            ]
        ]
    },
    {
        "id": "ee3602c42b9ca752",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "2aa576cb106287ce",
        "name": "dynamicoverlay.cgi",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Post",
        "cgi": "/axis-cgi/dynamicoverlay/dynamicoverlay.cgi",
        "data": "",
        "options": "",
        "filename": "",
        "x": 1680,
        "y": 2300,
        "wires": [
            [
                "6af7a17d7eaf6b2b"
            ]
        ]
    },
    {
        "id": "6af7a17d7eaf6b2b",
        "type": "join",
        "z": "326c4a626204f486",
        "g": "2aa576cb106287ce",
        "name": "",
        "mode": "auto",
        "build": "object",
        "property": "payload",
        "propertyType": "msg",
        "key": "topic",
        "joiner": "\\n",
        "joinerType": "str",
        "accumulate": "false",
        "timeout": "",
        "count": "",
        "reduceRight": false,
        "x": 1860,
        "y": 2300,
        "wires": [
            [
                "532b2ee02b27849a"
            ]
        ]
    },
    {
        "id": "8895aea9a9f3d1be",
        "type": "switch",
        "z": "326c4a626204f486",
        "g": "2aa576cb106287ce",
        "name": "Found previous",
        "property": "payload.length",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gt",
                "v": "0",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1170,
        "y": 2300,
        "wires": [
            [
                "d88b6b9c53d39099"
            ],
            [
                "f2d6ab0ff1e6d684"
            ]
        ]
    },
    {
        "id": "1b94296c0d401150",
        "type": "comment",
        "z": "326c4a626204f486",
        "g": "2aa576cb106287ce",
        "name": "Remove previous overlays",
        "info": "",
        "x": 440,
        "y": 2240,
        "wires": []
    },
    {
        "id": "50802d2561ec3866",
        "type": "link out",
        "z": "326c4a626204f486",
        "name": "link out 27",
        "mode": "link",
        "links": [
            "dd5c42dcc59fbfb9"
        ],
        "x": 2195,
        "y": 2340,
        "wires": []
    },
    {
        "id": "532b2ee02b27849a",
        "type": "delay",
        "z": "326c4a626204f486",
        "g": "2aa576cb106287ce",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 2010,
        "y": 2300,
        "wires": [
            [
                "50802d2561ec3866"
            ]
        ]
    },
    {
        "id": "b72b7783e027c102",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "f68112c44c6b906d",
        "name": "Set Overlay 1",
        "func": "if (!msg.config.hasOwnProperty(\"textOverlays\") || !Array.isArray(msg.config.textOverlays) || msg.config.textOverlays.length < 1 ) {\n    node.send([null,msg]);\n    return;\n}\n\nmsg.payload = {\n    apiVersion: \"1.6\",\n    method: \"addText\",\n    params: {\n        text: msg.config.textOverlays[0].text || \"%F %X\",\n        camera: 1,\n        position: msg.config.textOverlays[0].position || \"topLeft\",\n        reference: \"channel\",\n        textColor: msg.config.textOverlays[0].textColor || \"white\",\n        textBGColor: msg.config.textOverlays[0].textBGColor || \"black\",\n        textOLColor: \"transparent\",\n        fontSize: msg.config.textOverlays[0].fontSize || 48\n    }\n}\nreturn msg; \n",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 2500,
        "wires": [
            [
                "adf119416eac84ab"
            ],
            [
                "c55ec918a2d15797"
            ]
        ]
    },
    {
        "id": "b931e5bc682cea71",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "f68112c44c6b906d",
        "name": "Set Overlay 2",
        "func": "if (!msg.config.hasOwnProperty(\"textOverlays\") || !Array.isArray(msg.config.textOverlays) || msg.config.textOverlays.length < 2 ) {\n    node.send([null,msg]);\n    return;\n}\n\nmsg.payload = {\n    apiVersion: \"1.6\",\n    method: \"addText\",\n    params: {\n        text: msg.config.textOverlays[1].text || \"%F %X\",\n        camera: 1,\n        position: msg.config.textOverlays[1].position || \"topLeft\",\n        reference: \"channel\",\n        textColor: msg.config.textOverlays[1].textColor || \"white\",\n        textBGColor: msg.config.textOverlays[1].textBGColor || \"black\",\n        textOLColor: \"transparent\",\n        fontSize: msg.config.textOverlays[1].fontSize || 48\n    }\n}\nreturn msg; \n",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1010,
        "y": 2540,
        "wires": [
            [
                "0c3359e296d88dd8"
            ],
            [
                "34864d882054a373"
            ]
        ]
    },
    {
        "id": "88244c5b493b1c97",
        "type": "link in",
        "z": "326c4a626204f486",
        "name": "Image Overlays",
        "links": [
            "88f41124c523832d"
        ],
        "x": 255,
        "y": 2740,
        "wires": [
            [
                "739c5cb4e09b22a8"
            ]
        ]
    },
    {
        "id": "4c26f5714d41a4ed",
        "type": "link out",
        "z": "326c4a626204f486",
        "name": "link out 28",
        "mode": "link",
        "links": [
            "ee23349f1f1b8c8c"
        ],
        "x": 1515,
        "y": 2780,
        "wires": []
    },
    {
        "id": "def56cf9c90d2afd",
        "type": "comment",
        "z": "326c4a626204f486",
        "g": "2584543e15b45c4c",
        "name": "Set Image Overlay",
        "info": "",
        "x": 420,
        "y": 2680,
        "wires": []
    },
    {
        "id": "739c5cb4e09b22a8",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "2584543e15b45c4c",
        "name": "Upload Overlay",
        "func": "if (!msg.config.hasOwnProperty(\"imageOverlay\") || typeof msg.config.imageOverlay !== \"object\") {\n    node.send([null, msg]);\n    return;\n}\n\nif( !msg.config.imageOverlay.hasOwnProperty(\"filepath\") || msg.config.imageOverlay.filepath.length === 0 ) {\n    node.send([null, msg]);\n    return;\n}\n\nmsg.filename = msg.config.imageOverlay.filepath;\n\nmsg.payload = {\n    scale: msg.config.imageOverlay.scale || true\n//    alpha: msg.config.imageOverlay.alpha || 0\n}\nnode.send([msg,null]);\n",
        "outputs": 2,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 2740,
        "wires": [
            [
                "8e8e7e678a16252c"
            ],
            [
                "1bad663002407424"
            ]
        ]
    },
    {
        "id": "8e8e7e678a16252c",
        "type": "Axis camera",
        "z": "326c4a626204f486",
        "g": "2584543e15b45c4c",
        "name": "",
        "preset": "1af13a1540441ff9",
        "action": "Upload overlay",
        "resolution": "640x360",
        "output": "Base64",
        "filename": "",
        "options": "",
        "data": "",
        "x": 630,
        "y": 2740,
        "wires": [
            [
                "0960c0d22ecf070c"
            ]
        ]
    },
    {
        "id": "5c5ba15cfce44a67",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "2584543e15b45c4c",
        "name": "Set Overlay",
        "func": "var paths = msg.config.imageOverlay.filepath.split('/');\nvar name = paths[paths.length-1].split('.')[0]\n\nmsg.payload = {\n    apiVersion:\"1.6\",\n    method:\"addImage\",\n    params:{\n        camera:1,\n        overlayPath: \"/etc/overlays/\" + name + \".ovl\",\n        position: msg.config.imageOverlay.position || \"bottomRight\"\n    }\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1000,
        "y": 2740,
        "wires": [
            [
                "da087cefbcedb17e"
            ]
        ]
    },
    {
        "id": "196e771b66b4549f",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "2584543e15b45c4c",
        "name": "",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Post",
        "cgi": "/axis-cgi/dynamicoverlay/dynamicoverlay.cgi",
        "data": "",
        "options": "",
        "filename": "",
        "x": 1340,
        "y": 2740,
        "wires": [
            [
                "4c26f5714d41a4ed"
            ]
        ]
    },
    {
        "id": "f7b1ae528e5406cc",
        "type": "inject",
        "z": "326c4a626204f486",
        "g": "3cde0f5e5fa9ec4d",
        "name": "Download image overlay",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1600,
        "y": 220,
        "wires": [
            [
                "3fbd5c05eef07017"
            ]
        ]
    },
    {
        "id": "3fbd5c05eef07017",
        "type": "http request",
        "z": "326c4a626204f486",
        "g": "3cde0f5e5fa9ec4d",
        "name": "",
        "method": "GET",
        "ret": "bin",
        "paytoqs": "ignore",
        "url": "https://avatarfiles.alphacoders.com/789/78900.png",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 1840,
        "y": 220,
        "wires": [
            [
                "6d3cbe25c6482165"
            ]
        ]
    },
    {
        "id": "6d3cbe25c6482165",
        "type": "file",
        "z": "326c4a626204f486",
        "g": "3cde0f5e5fa9ec4d",
        "name": "",
        "filename": "staging/smiley.png",
        "filenameType": "str",
        "appendNewline": false,
        "createDir": true,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 2060,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "ee23349f1f1b8c8c",
        "type": "link in",
        "z": "326c4a626204f486",
        "name": "MQTT",
        "links": [
            "4c26f5714d41a4ed"
        ],
        "x": 255,
        "y": 2940,
        "wires": [
            [
                "ee46062e85730afe"
            ]
        ]
    },
    {
        "id": "5e7fc1a8c1e4a852",
        "type": "link out",
        "z": "326c4a626204f486",
        "name": "link out 15",
        "mode": "link",
        "links": [
            "b59aef61313a54fa"
        ],
        "x": 1935,
        "y": 2980,
        "wires": []
    },
    {
        "id": "d7eced934d70505d",
        "type": "template",
        "z": "326c4a626204f486",
        "g": "265fc0b774afd280",
        "name": "MQTT Config",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{\n    \"apiVersion\":\"1.5\",\n    \"method\":\"configureClient\",\n    \"params\":{\n        \"autoReconnect\":true,\n        \"cleanSession\":true,\n        \"clientId\": \"{{device.serial}}\",\n        \"connectTimeout\":60,\n        \"deviceTopicPrefix\":\"axis\",\n        \"id\":\"MqttClientConfig\",\n        \"keepAliveInterval\":60,\n        \"server\":{\n            \"host\": \"{{config.mqtt.address}}\",\n            \"id\":\"MqttClientServer\",\n            \"port\":1883,\n            \"protocol\":\"tcp\"\n        },\n        \"username\": \"{{config.mqtt.user}}\",\n        \"password\": \"{{config.mqtt.password}}\",\n        \"keepExistingPassword\":false\n    }\n}\n\n",
        "output": "str",
        "x": 650,
        "y": 2940,
        "wires": [
            [
                "bf458e5375867797"
            ]
        ],
        "info": "https://www.axis.com/vapix-library/subjects/t10175981/section/t10152603/display?section=t10152603-t10152921\r\n\r\n{\r\n  \"apiVersion\": \"<Major>.<Minor>\",\r\n  \"context\": <string>,\r\n  \"method\": \"configureClient\",\r\n  \"params\": {\r\n\r\n    \"server\": {\r\n      \"protocol\": <string>,\r\n      \"host\": <string>,\r\n      \"port\": <integer>,\r\n      \"basepath\": <string>,\r\n      \"alpnProtocol\": <string>\r\n    },\r\n\r\n    \"httpProxy\": <string>,\r\n    \"httpsProxy\": <string>,\r\n    \"username\": <string>,\r\n    \"password\": <string>,\r\n    \"keepExistingPassword\": <boolean>\r\n    \"clientId\": <string>,\r\n    \"keepAliveInterval\": <int>,\r\n    \"connectTimeout\": <int>,\r\n    \"cleanSession\": <boolean>,\r\n    \"autoReconnect\": <boolean>,\r\n    \"deviceTopicPrefix\": <string>,\r\n\r\n    \"lastWillTestament\": {\r\n      \"useDefault\": <boolean>,\r\n      \"topic\": <string>,\r\n      \"message\": <string>,\r\n      \"retain\": <boolean>,\r\n      \"qos\": <int>\r\n    },\r\n\r\n    \"connectMessage\": {\r\n      \"useDefault\": <boolean>,\r\n      \"topic\": <string>,\r\n      \"message\": <string>,\r\n      \"retain\": <boolean>,\r\n      \"qos\": <int>\r\n    },\r\n\r\n    \"disconnectMessage\": {\r\n      \"useDefault\": <boolean>,\r\n      \"topic\": <string>,\r\n      \"message\": <string>,\r\n      \"retain\": <boolean>,\r\n      \"qos\": <int>\r\n    },\r\n    \"ssl\": {\r\n      \"validateServerCert\": <boolean>,\r\n      \"clientCertID\": <string>,\r\n      \"CACertID\": <string>\r\n    }\r\n  }\r\n}\r\n"
    },
    {
        "id": "95730e517fbaba60",
        "type": "template",
        "z": "326c4a626204f486",
        "g": "265fc0b774afd280",
        "name": "Start MQTT",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{\n    \"apiVersion\":\"1.5\",\n    \"method\":\"activateClient\"\n}",
        "output": "str",
        "x": 1100,
        "y": 2940,
        "wires": [
            [
                "6bbb3f24fcae72db"
            ]
        ]
    },
    {
        "id": "bf458e5375867797",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "265fc0b774afd280",
        "name": "/axis-cgi/mqtt/client.cgi",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Post",
        "cgi": "/axis-cgi/mqtt/client.cgi",
        "data": "",
        "options": "",
        "filename": "",
        "x": 880,
        "y": 2940,
        "wires": [
            [
                "95730e517fbaba60"
            ]
        ]
    },
    {
        "id": "6bbb3f24fcae72db",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "265fc0b774afd280",
        "name": "/axis-cgi/mqtt/client.cgi",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Post",
        "cgi": "/axis-cgi/mqtt/client.cgi",
        "data": "",
        "options": "",
        "filename": "",
        "x": 1320,
        "y": 2940,
        "wires": [
            [
                "abe869d7622df0c6"
            ]
        ]
    },
    {
        "id": "234b7fe52ca39cd4",
        "type": "comment",
        "z": "326c4a626204f486",
        "g": "265fc0b774afd280",
        "name": "MQTT Client setup",
        "info": "",
        "x": 420,
        "y": 2880,
        "wires": []
    },
    {
        "id": "1986606316682d6a",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "265fc0b774afd280",
        "name": "/axis-cgi/mqtt/event.cgi",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Post",
        "cgi": "/axis-cgi/mqtt/event.cgi",
        "data": "",
        "options": "",
        "filename": "",
        "x": 1740,
        "y": 2940,
        "wires": [
            [
                "5e7fc1a8c1e4a852"
            ]
        ]
    },
    {
        "id": "ee46062e85730afe",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "265fc0b774afd280",
        "name": "Set MQTT Client",
        "func": "if (!msg.config.hasOwnProperty(\"mqtt\") || typeof msg.config.mqtt !== \"object\" ) {\n    node.send([null, msg]);\n    return;\n}\n\nif (!msg.config.mqtt.hasOwnProperty(\"address\") || msg.config.mqtt.address.length < 5) {\n    node.send([null, msg]);\n    return;\n}\n\nif (!msg.config.mqtt.hasOwnProperty(\"port\") )\n    msg.config.mqtt.port = \"1880\";\n\nif (!msg.config.mqtt.hasOwnProperty(\"user\"))\n    msg.config.mqtt.user = \"\";\n\nif (!msg.config.mqtt.hasOwnProperty(\"password\"))\n    msg.config.mqtt.pasword = \"\";\n\nnode.send([msg,null]);",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 2940,
        "wires": [
            [
                "d7eced934d70505d"
            ],
            [
                "177ca280438fd577"
            ]
        ]
    },
    {
        "id": "37103ed07643fd65",
        "type": "link in",
        "z": "326c4a626204f486",
        "name": "Zipstream",
        "links": [
            "ce36dfb9299bf2a2"
        ],
        "x": 235,
        "y": 1540,
        "wires": [
            [
                "e8e87775d2b7a916"
            ]
        ]
    },
    {
        "id": "083f37e50c09c17d",
        "type": "link out",
        "z": "326c4a626204f486",
        "name": "link out 25",
        "mode": "link",
        "links": [
            "fcedd833c527e980"
        ],
        "x": 1335,
        "y": 1580,
        "wires": []
    },
    {
        "id": "e8e87775d2b7a916",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "e5199098c110ef9d",
        "name": "Settings",
        "func": "if( !msg.config.hasOwnProperty(\"zipstream\") || typeof msg.config.zipstream !== \"object\" || !msg.config.zipstream.hasOwnProperty(\"strength\")) {\n    node.send([null,msg]);\n    return;\n}\n\nmsg.cgi = \"/axis-cgi/zipstream/setstrength.cgi?schemaversion=1\";\nmsg.cgi += \"&strength=\" + msg.config.zipstream.strength;\n//msg.cgi += \"&fpsmode=fixed\"\nmsg.cgi += \"&camera=1\";\nnode.send([msg,null]);",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 1540,
        "wires": [
            [
                "70bf97c7a27b922b"
            ],
            [
                "132463424d665729"
            ]
        ]
    },
    {
        "id": "70bf97c7a27b922b",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "e5199098c110ef9d",
        "name": "/axis-cgi/zipstream/setstrength.cgi",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Get",
        "cgi": "",
        "data": "",
        "options": "",
        "filename": "",
        "x": 630,
        "y": 1540,
        "wires": [
            [
                "cd6d4cd3be0bd9fc"
            ]
        ]
    },
    {
        "id": "85b247d0360781b4",
        "type": "comment",
        "z": "326c4a626204f486",
        "g": "e5199098c110ef9d",
        "name": "Zip Stream",
        "info": "",
        "x": 390,
        "y": 1480,
        "wires": []
    },
    {
        "id": "cd6d4cd3be0bd9fc",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "e5199098c110ef9d",
        "name": "Min FPS",
        "func": "if (!msg.config.hasOwnProperty(\"zipstream\") || typeof msg.config.zipstream !== \"object\" || !msg.config.zipstream.hasOwnProperty(\"minfps\")) {\n    node.send([null, msg]);\n    return;\n}\n\nmsg.cgi = \"/axis-cgi/zipstream/setminfps.cgi?schemaversion=1\";\nmsg.cgi += \"&minfps=\" + msg.config.zipstream.minfps;\nmsg.cgi += \"&camera=1\";\nnode.send([msg,null]);\n",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 870,
        "y": 1540,
        "wires": [
            [
                "a88d2f8182b45620"
            ],
            [
                "be2adcf3a4c03127"
            ]
        ]
    },
    {
        "id": "a88d2f8182b45620",
        "type": "Axis device",
        "z": "326c4a626204f486",
        "g": "e5199098c110ef9d",
        "name": "/axis-cgi/zipstream/setminfps.cgi",
        "preset": "1af13a1540441ff9",
        "action": "HTTP Get",
        "cgi": "",
        "data": "",
        "options": "",
        "filename": "",
        "x": 1110,
        "y": 1540,
        "wires": [
            [
                "083f37e50c09c17d"
            ]
        ]
    },
    {
        "id": "abe869d7622df0c6",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "265fc0b774afd280",
        "name": "Publish",
        "func": "if (!msg.config.mqtt.hasOwnProperty(\"publish\") || !Array.isArray(msg.config.mqtt.publish) || msg.config.mqtt.publish.length === 0 ) {\n    node.send([null,msg]);\n    return;\n}\n\nmsg.payload = {\n    apiVersion: \"1.2\",\n    method: \"configureEventPublication\",\n    params: {\n        appendEventTopic: true,\n        customTopicPrefix: \"event\",\n        eventFilterList: msg.config.mqtt.publish,\n        includeSerialNumberInPayload: true,\n        includeTopicNamespaces: false,\n        topicPrefix: \"custom\"\n    }\n}\nnode.send([msg,null]);",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1530,
        "y": 2940,
        "wires": [
            [
                "1986606316682d6a"
            ],
            [
                "1f5aa0014307c385"
            ]
        ]
    },
    {
        "id": "2580e585c59bdc99",
        "type": "debug",
        "z": "326c4a626204f486",
        "name": "debug 217",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 860,
        "y": 140,
        "wires": []
    },
    {
        "id": "625b86ce52be741b",
        "type": "debug",
        "z": "326c4a626204f486",
        "name": "debug 218",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 860,
        "y": 200,
        "wires": []
    },
    {
        "id": "6a286cf74bf76163",
        "type": "change",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "error",
        "rules": [
            {
                "t": "delete",
                "p": "error",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 520,
        "y": 2000,
        "wires": [
            [
                "e616354b51e45f6e"
            ]
        ]
    },
    {
        "id": "04c5e945ebc9e6d1",
        "type": "change",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "error",
        "rules": [
            {
                "t": "delete",
                "p": "error",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1080,
        "y": 2060,
        "wires": [
            [
                "2834e578f9eff775"
            ]
        ]
    },
    {
        "id": "2479d63d1095c530",
        "type": "change",
        "z": "326c4a626204f486",
        "g": "2f31d414d432f126",
        "name": "error",
        "rules": [
            {
                "t": "delete",
                "p": "error",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1660,
        "y": 2120,
        "wires": [
            [
                "d4f86898d10f9de4"
            ]
        ]
    },
    {
        "id": "0960c0d22ecf070c",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "2584543e15b45c4c",
        "name": "Validate",
        "func": "if( msg.payload.hasOwnProperty(\"error\") ) {\n    node.warn(msg.payload.error.message);\n    node.send([null,msg]);\n    return;\n}\nnode.send([msg,null]);",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 830,
        "y": 2740,
        "wires": [
            [
                "5c5ba15cfce44a67"
            ],
            [
                "efbf81751bd93e46"
            ]
        ]
    },
    {
        "id": "da087cefbcedb17e",
        "type": "function",
        "z": "326c4a626204f486",
        "g": "2584543e15b45c4c",
        "name": "Validate",
        "func": "if( msg.payload.hasOwnProperty(\"error\") ) {\n    node.warn(msg.payload.error.message);\n    node.send([null,msg]);\n    return;\n}\nnode.send([msg,null]);",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1170,
        "y": 2740,
        "wires": [
            [
                "196e771b66b4549f"
            ],
            [
                "1e9df55b3778e57b"
            ]
        ]
    },
    {
        "id": "fce46974ec0f7e47",
        "type": "comment",
        "z": "326c4a626204f486",
        "g": "3cde0f5e5fa9ec4d",
        "name": "Required files",
        "info": "",
        "x": 1560,
        "y": 160,
        "wires": []
    },
    {
        "id": "f03556f38ac1e468",
        "type": "comment",
        "z": "326c4a626204f486",
        "name": "Version 0.5  [README]",
        "info": "# Usage\n1. Edit the orange \"System Config\"\n2. Edit the orange \"Device Inventory\"\n3. Inject the blue \"Set System Config\"\n4. Inject the blue \"Commit Stating\"\n\n# Config Description\nThe System Config holds all configuration.  You can remove properties that you do not want.  Values with empty data will not be commited to the staging.\n\n\n## \"accounts\"\nUp to three accounts can be set.  THe first is the main account that will be used for all configuration.  Ty\n[\n        {\n            \"name\": \"root\",\n            \"password\": \"pass\",\n            \"privileges\": \"Admin\"\n        }\n]\n\n## \"timezone\"\nEurope/Stockholm\",\n\n## \"zipstream\": \n{\n    \"strength\": 20,\n    \"minfps\": 15\n}\n\n## \"tls\":\n{\n        \"policy\": \"HttpAndHttps\"\n}\n## \"textOverlays\":\n[\n    {\n        \"text\": \"%F %X\",\n        \"position\": \"topLeft\",\n        \"textColor\": \"white\",\n        \"textBGColor\": \"black\",\n        \"fontSize\": 48\n    },\n    {\n        \"text\": \"#n\",\n        \"position\": \"topRight\",\n        \"textColor\": \"white\",\n        \"textBGColor\": \"transparent\",\n        \"fontSize\": 48\n    }\n]\n\n## \"imageOverlay\":\n{\n    \"filepath\": \"staging/smiley.png\",\n    \"position\":\"bottomRight\",\n    \"scale\": true\n}\n    \n## \"onvif\":\n[\n    {\n        \"name\": \"user1\",\n        \"password\": \"user2\",\n        \"privileges\": \"Administrator\"\n    }\n]\n\n## \"mqtt\":\n{\n    \"address\":\"\",\n    \"user\": \"\",\n    \"password\":\"\",\n    \"publish\": [\n\t\t{\n\t\t\t\"qos\": 0,\n\t\t\t\"retain\": \"none\",\n\t\t\t\"topicFilter\": \"axis:CameraApplicationPlatform/ObjectAnalytics/Device1Scenario1\"\n\t\t},\n\t\t{\n\t\t\t\"qos\": 0,\n\t\t\t\"retain\": \"none\",\n\t\t\t\"topicFilter\": \"axis:CameraApplicationPlatform/ObjectAnalytics/Device1Scenario2\"\n\t\t}\n\t]\n}\n\n## \"ssh\":\n{\n    \"name\": \"\",\n    \"password\":\"\"\n}\n\n## acaps\":\n[\n    {\n        \"package\": \"\",\n        \"eap\":{\n            \"armv7hf\": \"\",\n            \"aarch64\": \"\"\n        },\n        \"config\": {\n            \"url\": \"\",\n            \"data\": \"\"\n        }\n    }\n]\n\n\n\n",
        "x": 200,
        "y": 60,
        "wires": []
    },
    {
        "id": "1af13a1540441ff9",
        "type": "Device Access",
        "name": "Staging",
        "address": "",
        "protocol": "http"
    }
]

[{"id":"acd34c59.89bb1","type":"function","z":"2f71629f.96151e","name":"VAPIX: List Actions","func":"msg.payload = '' +\n'<?xml version=\"1.0\" encoding=\"UTF-8\"?>' +\n'<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://www.w3.org/2003/05/soap-envelope\">' +\n    '<SOAP-ENV:Header/>' +\n    '<SOAP-ENV:Body xmlns:act=\"http://www.axis.com/vapix/ws/action1\">' + \n        '<act:GetActionConfigurations/>' + \n    '</SOAP-ENV:Body>' +\n'</SOAP-ENV:Envelope>';\nreturn msg;\n","outputs":1,"noerr":0,"x":160,"y":340,"wires":[["f9ba0a9c.d5e22"]]},{"id":"f9ba0a9c.d5e22","type":"http request","z":"2f71629f.96151e","name":"Cameras","method":"POST","ret":"txt","paytoqs":false,"url":"","tls":"","proxy":"","authType":"digest","x":420,"y":340,"wires":[["2101fe4a.9529ea"]]},{"id":"2101fe4a.9529ea","type":"xml","z":"2f71629f.96151e","name":"","property":"payload","attr":"","chr":"","x":570,"y":340,"wires":[["9d0958c9.f6c268"]]},{"id":"9d0958c9.f6c268","type":"function","z":"2f71629f.96151e","name":"Parse","func":"list = [];\nactions = msg.payload['SOAP-ENV:Envelope']['SOAP-ENV:Body'][0]['aa:GetActionConfigurationsResponse'][0]['aa:ActionConfigurations'][0]\nif( typeof actions !== 'object' ) {\n    msg.payload = list;\n    return msg;\n}\n\nactions = actions['aa:ActionConfiguration'];\n\nactions.forEach(function(item){\n    action = {\n        id: item['aa:ConfigurationID'][0],\n        template: item['aa:TemplateToken'][0],\n        name: item['aa:Name'][0],\n    }\n    parameters = item['aa:Parameters'][0]['aa:Parameter'];\n    parameters.forEach(function(param){\n        p = param['$']\n        action[p.Name] = p.Value;\n    })\n    list.push(action)\n})\nmsg.payload = list;\nreturn msg;\n","outputs":1,"noerr":0,"x":670,"y":340,"wires":[[]]}]

[{"id":"976bced5.f6262","type":"ui_button","z":"5ef7dbe6.d94bd4","name":"Refresh","group":"508d9780.b88948","order":1,"width":"1","height":"1","passthru":false,"label":"","tooltip":"","color":"","bgcolor":"","icon":"refresh","payload":"","payloadType":"str","topic":"","x":120,"y":80,"wires":[["74c6526b.4c8bc4"]]},{"id":"c17b28eb.2ad058","type":"function","z":"5ef7dbe6.d94bd4","name":"Properties","func":"msg.payload = \"properties\"\nreturn msg;","outputs":1,"noerr":0,"x":320,"y":680,"wires":[["3bf98145.49fc26"]]},{"id":"3bf98145.49fc26","type":"Axis Camera","z":"5ef7dbe6.d94bd4","name":"","account":"519451ca.77388","address":"","action":"Get Properties","data":"","format":"default","x":560,"y":680,"wires":[["c8d036e.4ee7848"]]},{"id":"11f50a2.1782676","type":"debug","z":"5ef7dbe6.d94bd4","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":910,"y":680,"wires":[]},{"id":"c8d036e.4ee7848","type":"function","z":"5ef7dbe6.d94bd4","name":"Parse","func":"if(msg.error){\n    node.warn(msg.payload)\n    return;\n}\n\nmsg.camera.platform = msg.payload.System.Architecture;\nmsg.camera.chip = msg.payload.System.Soc;\nmsg.camera.firmware = msg.payload.Firmware.Version;\n\nreturn msg;","outputs":1,"noerr":0,"x":750,"y":680,"wires":[["11f50a2.1782676","9ac66a62.4a06c8"]]},{"id":"9ac66a62.4a06c8","type":"function","z":"5ef7dbe6.d94bd4","name":"Brand","func":"msg.payload = \"brand\"\nreturn msg;","outputs":1,"noerr":0,"x":310,"y":720,"wires":[["5791fbc1.8677a4"]]},{"id":"5791fbc1.8677a4","type":"Axis Camera","z":"5ef7dbe6.d94bd4","name":"","account":"519451ca.77388","address":"","action":"Get Properties","data":"","format":"default","x":560,"y":720,"wires":[["57506414.8e47fc"]]},{"id":"8ece8a98.1c8a6","type":"debug","z":"5ef7dbe6.d94bd4","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":910,"y":720,"wires":[]},{"id":"57506414.8e47fc","type":"function","z":"5ef7dbe6.d94bd4","name":"Parse","func":"if(msg.error){\n    node.warn(msg.payload)\n    return;\n}\n\nmsg.camera.model = msg.payload.ProdNbr;\nmsg.camera.type = msg.payload.ProdType;\n\nreturn msg;","outputs":1,"noerr":0,"x":750,"y":720,"wires":[["8ece8a98.1c8a6","a1c5abd.8f71f58"]]},{"id":"a1c5abd.8f71f58","type":"function","z":"5ef7dbe6.d94bd4","name":"Network","func":"msg.payload = \"network\"\nreturn msg;","outputs":1,"noerr":0,"x":320,"y":760,"wires":[["ce42c3fc.b8a0c"]]},{"id":"ce42c3fc.b8a0c","type":"Axis Camera","z":"5ef7dbe6.d94bd4","name":"","account":"519451ca.77388","address":"","action":"Get Properties","data":"","format":"default","x":560,"y":760,"wires":[["e45e16bf.d51c38"]]},{"id":"e45e16bf.d51c38","type":"function","z":"5ef7dbe6.d94bd4","name":"Parse","func":"if(msg.error){\n    node.warn(msg.payload)\n    return;\n}\n\nmsg.camera.mac = msg.payload.eth0.MACAddress\nmsg.camera.hostName = msg.payload.VolatileHostName.HostName\nmsg.camera.ipv4 = msg.payload.eth0.IPAddress\n\nreturn msg;","outputs":1,"noerr":0,"x":750,"y":760,"wires":[["16c593a8.6f0ae4","9319609d.558"]]},{"id":"16c593a8.6f0ae4","type":"debug","z":"5ef7dbe6.d94bd4","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":910,"y":760,"wires":[]},{"id":"9319609d.558","type":"function","z":"5ef7dbe6.d94bd4","name":"Sensor","func":"msg.payload = \"ImageSource.I0\"\nreturn msg;","outputs":1,"noerr":0,"x":320,"y":800,"wires":[["482e871a.aeadb8"]]},{"id":"482e871a.aeadb8","type":"Axis Camera","z":"5ef7dbe6.d94bd4","name":"","account":"519451ca.77388","address":"","action":"Get Properties","data":"","format":"default","x":560,"y":800,"wires":[["846b2f6.f09295"]]},{"id":"846b2f6.f09295","type":"function","z":"5ef7dbe6.d94bd4","name":"Parse","func":"if(msg.error){\n    node.warn(msg.payload)\n    return;\n}\n\nmsg.camera.capture = msg.payload.I0.CaptureFrequency\nmsg.camera.rotation = parseInt(msg.payload.I0.Rotation)\nmsg.camera.aspect = msg.payload.I0.Sensor.AspectRatio\n\nreturn msg;","outputs":1,"noerr":0,"x":750,"y":800,"wires":[["46eb2e95.b64c1","b480d237.05e6b8"]]},{"id":"46eb2e95.b64c1","type":"debug","z":"5ef7dbe6.d94bd4","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":910,"y":800,"wires":[]},{"id":"b480d237.05e6b8","type":"function","z":"5ef7dbe6.d94bd4","name":"Update","func":"msg.payload = [\n    { serial: msg.camera.serial },\n    {\n        '$set': msg.camera\n    },\n    { upsert: true }\n];\nreturn msg;\n","outputs":1,"noerr":0,"x":310,"y":840,"wires":[["95a70926.dc958"]]},{"id":"95a70926.dc958","type":"mongodb2 in","z":"5ef7dbe6.d94bd4","service":"_ext_","configNode":"a2b65a4.ac5fc28","name":"","collection":"cameras","operation":"update","x":540,"y":840,"wires":[[]]},{"id":"74c6526b.4c8bc4","type":"mongodb2 in","z":"5ef7dbe6.d94bd4","service":"_ext_","configNode":"a2b65a4.ac5fc28","name":"","collection":"cameras","operation":"aggregate.toArray","x":390,"y":80,"wires":[["4baa4b66.4a6f54"]]},{"id":"4baa4b66.4a6f54","type":"ui_table","z":"5ef7dbe6.d94bd4","group":"508d9780.b88948","name":"","order":5,"width":"17","height":"9","columns":[{"field":"name","title":"Name","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"hostName","title":"Host Name","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"model","title":"Model","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"address","title":"Address","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"ipv4","title":"IP","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"serial","title":"Serial","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"firmware","title":"Firmware","width":"","align":"left","formatter":"plaintext","formatterParams":{"target":"_blank"}}],"outputs":1,"cts":true,"x":630,"y":80,"wires":[["74c6526b.4c8bc4","e61d82f1.9822a"]]},{"id":"91f55e8.30e13a","type":"ui_form","z":"5ef7dbe6.d94bd4","name":"Edit","label":"","group":"508d9780.b88948","order":6,"width":"5","height":"4","options":[{"label":"Name","value":"name","type":"text","required":false,"rows":null},{"label":"Address","value":"address","type":"text","required":false,"rows":null}],"formValue":{"name":"","address":""},"payload":"","submit":"Save","cancel":"","topic":"","x":450,"y":300,"wires":[["6da5a45.ca1cc5c"]]},{"id":"6da5a45.ca1cc5c","type":"function","z":"5ef7dbe6.d94bd4","name":"Update","func":"camera = flow.get(\"camera\");\nif(!camera) return;\n\nmsg.payload = [\n    { serial: camera.serial },\n    {\n        '$set': msg.payload\n    },\n    { upsert: true }\n];\nreturn msg;\n","outputs":1,"noerr":0,"x":600,"y":300,"wires":[["d1e8802.83828"]]},{"id":"d1e8802.83828","type":"mongodb2 in","z":"5ef7dbe6.d94bd4","service":"_ext_","configNode":"a2b65a4.ac5fc28","name":"","collection":"cameras","operation":"update","x":820,"y":300,"wires":[["5171d876.902b2","d66bf90b.8c634"]]},{"id":"e61d82f1.9822a","type":"function","z":"5ef7dbe6.d94bd4","name":"Camera","func":"delete msg.payload._id\nflow.set(\"camera\",msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":780,"y":80,"wires":[["22b36422.fb0e9c"]]},{"id":"d67ed284.995c6","type":"link in","z":"5ef7dbe6.d94bd4","name":"Refresh Table","links":["5171d876.902b2","9897cb20.538398"],"x":175,"y":120,"wires":[["74c6526b.4c8bc4"]]},{"id":"692b62c2.f8099c","type":"comment","z":"5ef7dbe6.d94bd4","name":"Refresh","info":"","x":110,"y":120,"wires":[]},{"id":"5171d876.902b2","type":"link out","z":"5ef7dbe6.d94bd4","name":"","links":["d67ed284.995c6"],"x":995,"y":300,"wires":[]},{"id":"46391f63.0a4598","type":"comment","z":"5ef7dbe6.d94bd4","name":"Refresh","info":"","x":1070,"y":300,"wires":[]},{"id":"37cbd5f5.57d922","type":"function","z":"5ef7dbe6.d94bd4","name":"Reset","func":"flow.set(\"camera\");\nmsg.payload = {\n    name: \"\",\n    address: \"\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":310,"y":340,"wires":[["91f55e8.30e13a"]]},{"id":"ac37bda8.effdc8","type":"ui_button","z":"5ef7dbe6.d94bd4","name":"","group":"508d9780.b88948","order":3,"width":"4","height":"1","passthru":false,"label":"Refresh Camera","tooltip":"","color":"","bgcolor":"","icon":"refresh","payload":"","payloadType":"str","topic":"","x":170,"y":420,"wires":[["6e79bf10.c06488"]]},{"id":"6e79bf10.c06488","type":"function","z":"5ef7dbe6.d94bd4","name":"Camera","func":"msg.camera = flow.get(\"camera\");\nif(!msg.camera) return;\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":420,"wires":[["a356b7d2.dbf6c8"]]},{"id":"ee5e748a.56845","type":"link in","z":"5ef7dbe6.d94bd4","name":"Refresh Camera","links":["a356b7d2.dbf6c8","333a918e.005776"],"x":195,"y":640,"wires":[["62b591cc.5a6d2","8482abad.344a08"]]},{"id":"d8c64791.37c7a","type":"comment","z":"5ef7dbe6.d94bd4","name":"Refresh","info":"","x":130,"y":640,"wires":[]},{"id":"a356b7d2.dbf6c8","type":"link out","z":"5ef7dbe6.d94bd4","name":"","links":["ee5e748a.56845"],"x":595,"y":420,"wires":[]},{"id":"93d498d9.86257","type":"link in","z":"5ef7dbe6.d94bd4","name":"","links":["d66bf90b.8c634","d71ecfef.d76228"],"x":215,"y":340,"wires":[["37cbd5f5.57d922"]]},{"id":"dc803587.cb4538","type":"comment","z":"5ef7dbe6.d94bd4","name":"Reset","info":"","x":130,"y":340,"wires":[]},{"id":"d66bf90b.8c634","type":"link out","z":"5ef7dbe6.d94bd4","name":"","links":["93d498d9.86257"],"x":995,"y":340,"wires":[]},{"id":"b6e766ff.511ad8","type":"comment","z":"5ef7dbe6.d94bd4","name":"Reset","info":"","x":1070,"y":340,"wires":[]},{"id":"5b13cae0.57d01c","type":"comment","z":"5ef7dbe6.d94bd4","name":"Refresh List","info":"","x":690,"y":420,"wires":[]},{"id":"22b36422.fb0e9c","type":"link out","z":"5ef7dbe6.d94bd4","name":"","links":["721df30.1692b0c"],"x":895,"y":80,"wires":[]},{"id":"18c2b9cc.f0d6ae","type":"comment","z":"5ef7dbe6.d94bd4","name":"Edit","info":"","x":970,"y":80,"wires":[]},{"id":"721df30.1692b0c","type":"link in","z":"5ef7dbe6.d94bd4","name":"Edit Camera","links":["22b36422.fb0e9c"],"x":215,"y":300,"wires":[["91f55e8.30e13a"]]},{"id":"1ce2a5a.0b07e5a","type":"comment","z":"5ef7dbe6.d94bd4","name":"Edit","info":"","x":130,"y":300,"wires":[]},{"id":"69f7b6fc.9d488","type":"ui_button","z":"5ef7dbe6.d94bd4","name":"","group":"508d9780.b88948","order":8,"width":"4","height":"1","passthru":false,"label":"Delete Camera","tooltip":"","color":"","bgcolor":"red","icon":"delete","payload":"","payloadType":"str","topic":"","x":160,"y":460,"wires":[["3e0ac170.dc062e"]]},{"id":"3e0ac170.dc062e","type":"function","z":"5ef7dbe6.d94bd4","name":"Camera","func":"msg.camera = flow.get(\"camera\");\nif(!msg.camera) return;\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":460,"wires":[["e26427e4.f9a0a"]]},{"id":"5603bb4e.069044","type":"ui_template","z":"5ef7dbe6.d94bd4","group":"508d9780.b88948","name":"Operations","order":7,"width":"6","height":"1","format":"<h2>Operations</h2>","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":150,"y":380,"wires":[[]]},{"id":"e26427e4.f9a0a","type":"function","z":"5ef7dbe6.d94bd4","name":"Remove","func":"msg.payload = {\n    serial: msg.camera.serial\n}\nreturn msg;","outputs":1,"noerr":0,"x":520,"y":460,"wires":[["6779e022.464fa"]]},{"id":"6779e022.464fa","type":"mongodb2 in","z":"5ef7dbe6.d94bd4","service":"_ext_","configNode":"a2b65a4.ac5fc28","name":"","collection":"cameras","operation":"deleteOne","x":750,"y":460,"wires":[["9897cb20.538398","d71ecfef.d76228"]]},{"id":"9897cb20.538398","type":"link out","z":"5ef7dbe6.d94bd4","name":"","links":["d67ed284.995c6"],"x":955,"y":460,"wires":[]},{"id":"124fc1b.80f5f3e","type":"comment","z":"5ef7dbe6.d94bd4","name":"Refresh List","info":"","x":1050,"y":460,"wires":[]},{"id":"d71ecfef.d76228","type":"link out","z":"5ef7dbe6.d94bd4","name":"","links":["93d498d9.86257"],"x":955,"y":500,"wires":[]},{"id":"db2a4e00.a045b","type":"comment","z":"5ef7dbe6.d94bd4","name":"Reset","info":"","x":1030,"y":500,"wires":[]},{"id":"e4f91722.1f7478","type":"ui_text_input","z":"5ef7dbe6.d94bd4","name":"Add Camera by ID","label":"Add Camera by Address","tooltip":"","group":"508d9780.b88948","order":2,"width":"4","height":"1","passthru":false,"mode":"text","delay":"0","topic":"","x":150,"y":160,"wires":[[]]},{"id":"62b591cc.5a6d2","type":"function","z":"5ef7dbe6.d94bd4","name":"Camera","func":"msg.camera = flow.get(\"camera\");\nif(!msg.camera) {\n    node.warn(\"Invalid camera\")\n    return;\n}\nmsg.address = msg.camera.address;    \nreturn msg;","outputs":1,"noerr":0,"x":320,"y":640,"wires":[["c17b28eb.2ad058","42968238.198cac"]]},{"id":"42968238.198cac","type":"debug","z":"5ef7dbe6.d94bd4","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":490,"y":640,"wires":[]},{"id":"8482abad.344a08","type":"debug","z":"5ef7dbe6.d94bd4","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":350,"y":600,"wires":[]},{"id":"508d9780.b88948","type":"ui_group","z":"","name":"List","tab":"f69cd240.5e323","disp":false,"width":"24","collapse":false},{"id":"519451ca.77388","type":"Camera Account","z":"","name":"Hackaton","protocol":"http"},{"id":"a2b65a4.ac5fc28","type":"mongodb2","z":"","uri":"mongodb://localhost:27017/inventory","name":"Inventory","options":"","parallelism":"-1"},{"id":"f69cd240.5e323","type":"ui_tab","z":"","name":"Inventory Cameras","icon":"dashboard","order":1,"disabled":false,"hidden":false}]
